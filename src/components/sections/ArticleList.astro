---
import ArticleCard from "@components/article/ArticleCard.astro";
import Container from "@components/Container.astro";
import type { BlogPost } from "@contentful";
import { contentfulClient } from '@contentful';
import { formatDate } from '@helpers';

interface Props {
  limit?: number;
}

const { limit = 5 } = Astro.props;

const entries = await contentfulClient.getEntries<BlogPost>({ content_type: 'blogPost', limit });
const posts = entries.items.map((item) => {
  const { fields: {
    title, date, description, slug
  }, metadata: { tags } } = item;

  return {
    title,
    slug,
    description,
    tags,
    date: formatDate(date)
  };
});

export type PostListItem = typeof posts[number];
---

<div class="py-8 md:py-10 min-h-dvh" id="writing">
  <Container>
    <h2 class="section-title mb-6">Tulisan Terbaru</h2>
    <div class="space-y-6">
      {posts.map((post) => <ArticleCard {post} />)}
    </div>
  </Container>
</div>
